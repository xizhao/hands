---
title: Dashboard
description: "Dashboard page handlers"
---

# Dashboard

Dashboard handlers create serverless web pages that display your data through widgets.

## Import

```typescript
import { dashboard } from "@hands/stdlib";
```

## Basic Usage

```typescript
// dashboards/main.ts
import { dashboard } from "@hands/stdlib";

export const handler = dashboard(async (ctx) => {
  const [stats] = await ctx.sql`
    SELECT
      COUNT(*) as users,
      SUM(revenue) as revenue
    FROM users
  `;

  return {
    title: "Dashboard",
    widgets: [
      { type: "metric", label: "Users", value: stats.users },
      { type: "metric", label: "Revenue", value: "$" + stats.revenue }
    ]
  };
});
```

## Context Object

| Property | Type | Description |
|----------|------|-------------|
| `sql` | `SqlClient` | Database query client |
| `log` | `(msg: string) => void` | Structured logging |
| `env` | `Record<string, string>` | Environment variables |
| `params` | `Record<string, string>` | URL query parameters |

### Query Parameters

```typescript
export const handler = dashboard(async (ctx) => {
  const dateRange = ctx.params.range || "7d";

  const data = await ctx.sql`
    SELECT * FROM orders
    WHERE created_at > NOW() - INTERVAL ${dateRange}
  `;

  // ...
});
```

## Return Value

Dashboards return a title and array of widgets:

```typescript
return {
  title: "Sales Dashboard",
  widgets: [
    // Metrics, charts, tables, text
  ]
};
```

## Widget Types

### Metric

Display a single value prominently:

```typescript
{
  type: "metric",
  label: "Total Revenue",
  value: "$125,430",
  change: "+12.5%",       // Optional
  trend: "up"             // "up", "down", "neutral"
}
```

### Chart

Render a chart from data:

```typescript
{
  type: "chart",
  chartType: "line",      // "line", "bar", "pie", "area"
  title: "Revenue Trend",
  data: [
    { date: "2024-01", value: 10000 },
    { date: "2024-02", value: 12000 },
    // ...
  ]
}
```

### Table

Display tabular data:

```typescript
{
  type: "table",
  title: "Recent Orders",
  columns: ["Order ID", "Customer", "Amount", "Date"],
  rows: [
    ["#1234", "Acme Corp", "$999", "2024-01-15"],
    ["#1235", "GlobalTech", "$1,499", "2024-01-14"],
    // ...
  ]
}
```

### Text

Display markdown text:

```typescript
{
  type: "text",
  content: "## Summary\n\nThis dashboard shows key metrics..."
}
```

## Configuration

Register in `hands.config.ts`:

```typescript
import { defineConfig } from "@hands/stdlib";

export default defineConfig({
  dashboards: {
    main: {
      title: "Main Dashboard",
      handler: "dashboards/main.handler",
      auth: false  // Public access
    },

    admin: {
      title: "Admin Dashboard",
      handler: "dashboards/admin.handler",
      auth: true   // Requires authentication
    }
  }
});
```

## Complete Example

```typescript
// dashboards/sales.ts
import { dashboard } from "@hands/stdlib";

export const handler = dashboard(async (ctx) => {
  // Get metrics
  const [metrics] = await ctx.sql`
    SELECT
      SUM(amount) as revenue,
      COUNT(*) as orders,
      COUNT(DISTINCT customer_id) as customers
    FROM orders
    WHERE created_at > NOW() - INTERVAL '30 days'
  `;

  // Get trend data
  const trend = await ctx.sql`
    SELECT
      date_trunc('day', created_at) as date,
      SUM(amount) as value
    FROM orders
    WHERE created_at > NOW() - INTERVAL '30 days'
    GROUP BY 1 ORDER BY 1
  `;

  // Get top products
  const topProducts = await ctx.sql`
    SELECT name, SUM(quantity) as sold
    FROM order_items
    JOIN products ON products.id = product_id
    GROUP BY name
    ORDER BY sold DESC
    LIMIT 10
  `;

  return {
    title: "Sales Dashboard",
    widgets: [
      // Metric row
      { type: "metric", label: "Revenue", value: "$" + metrics.revenue },
      { type: "metric", label: "Orders", value: metrics.orders },
      { type: "metric", label: "Customers", value: metrics.customers },

      // Revenue chart
      {
        type: "chart",
        chartType: "line",
        title: "Daily Revenue",
        data: trend
      },

      // Top products table
      {
        type: "table",
        title: "Top Products",
        columns: ["Product", "Units Sold"],
        rows: topProducts.map(p => [p.name, p.sold])
      }
    ]
  };
});
```

## Rendering

Dashboards can render as:

- **HTML** - Full page with styling (default)
- **JSON** - Raw data for custom frontends

Access JSON with the `?format=json` query parameter.

## Styling

Dashboards use default styling. Customize by creating React components in `src/pages/` instead.

## TypeScript Types

```typescript
import {
  dashboard,
  DashboardContext,
  DashboardResult,
  Widget
} from "@hands/stdlib";

export const handler = dashboard(
  async (ctx: DashboardContext): Promise<DashboardResult> => {
    // ...
  }
);
```

## Next Steps

<CardGroup cols={2}>
  <Card title="Integration" icon="plug" href="/stdlib/integration">
    External data connectors
  </Card>
  <Card title="Configuration" icon="gear" href="/stdlib/config">
    Full config reference
  </Card>
</CardGroup>
