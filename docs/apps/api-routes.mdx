---
title: API Routes
description: "Create HTTP endpoints for your data"
---

# API Routes

API routes let you expose your data via HTTP. Build REST APIs, webhooks, or custom endpoints using the Hono framework.

## Creating Routes

Ask the AI:

```
Create an API endpoint that returns all customers

Add a POST endpoint to create new orders

Make a webhook endpoint for Stripe
```

## Route Structure

Routes are defined in `src/index.tsx`:

```typescript
import { Hono } from "hono";
import { createDb } from "./lib/db";

const app = new Hono<{ Bindings: Bindings }>();

// GET endpoint
app.get("/api/customers", async (c) => {
  const sql = createDb(c.env.DATABASE_URL);
  const customers = await sql`SELECT * FROM customers`;
  return c.json(customers);
});

// POST endpoint
app.post("/api/orders", async (c) => {
  const body = await c.req.json();
  const sql = createDb(c.env.DATABASE_URL);

  const [order] = await sql`
    INSERT INTO orders (customer_id, amount)
    VALUES (${body.customerId}, ${body.amount})
    RETURNING *
  `;

  return c.json(order, 201);
});

export default { fetch: app.fetch };
```

## HTTP Methods

```typescript
app.get("/path", handler)     // Read data
app.post("/path", handler)    // Create data
app.put("/path", handler)     // Update data
app.delete("/path", handler)  // Delete data
app.patch("/path", handler)   // Partial update
```

## URL Parameters

```typescript
// /api/customers/123
app.get("/api/customers/:id", async (c) => {
  const id = c.req.param("id");
  const sql = createDb(c.env.DATABASE_URL);

  const [customer] = await sql`
    SELECT * FROM customers WHERE id = ${id}
  `;

  if (!customer) {
    return c.json({ error: "Not found" }, 404);
  }

  return c.json(customer);
});
```

## Query Parameters

```typescript
// /api/orders?status=pending&limit=10
app.get("/api/orders", async (c) => {
  const status = c.req.query("status");
  const limit = parseInt(c.req.query("limit") || "100");

  const sql = createDb(c.env.DATABASE_URL);
  const orders = await sql`
    SELECT * FROM orders
    WHERE status = ${status}
    LIMIT ${limit}
  `;

  return c.json(orders);
});
```

## Request Body

```typescript
app.post("/api/customers", async (c) => {
  const body = await c.req.json();
  const { name, email, company } = body;

  const sql = createDb(c.env.DATABASE_URL);
  const [customer] = await sql`
    INSERT INTO customers (name, email, company)
    VALUES (${name}, ${email}, ${company})
    RETURNING *
  `;

  return c.json(customer, 201);
});
```

## Response Types

```typescript
// JSON
return c.json({ data: results });

// Text
return c.text("Hello World");

// HTML
return c.html("<h1>Hello</h1>");

// With status code
return c.json({ error: "Not found" }, 404);

// With headers
return c.json(data, 200, {
  "Cache-Control": "max-age=3600"
});
```

## Error Handling

```typescript
app.get("/api/risky", async (c) => {
  try {
    const result = await doSomethingRisky();
    return c.json(result);
  } catch (error) {
    console.error(error);
    return c.json({
      error: "Something went wrong",
      message: error.message
    }, 500);
  }
});
```

Or use middleware:

```typescript
app.onError((err, c) => {
  console.error(err);
  return c.json({ error: err.message }, 500);
});
```

## Middleware

Add middleware for auth, logging, etc:

```typescript
// Auth middleware
const auth = async (c, next) => {
  const token = c.req.header("Authorization");
  if (!token) {
    return c.json({ error: "Unauthorized" }, 401);
  }
  // Validate token...
  await next();
};

// Apply to routes
app.use("/api/*", auth);

// Or specific routes
app.get("/api/secret", auth, async (c) => {
  return c.json({ secret: "data" });
});
```

## CORS

Enable cross-origin requests:

```typescript
import { cors } from "hono/cors";

app.use("/api/*", cors());

// Or with options
app.use("/api/*", cors({
  origin: "https://myapp.com",
  allowMethods: ["GET", "POST"]
}));
```

## Webhooks

Handle incoming webhooks:

```typescript
app.post("/webhooks/stripe", async (c) => {
  const body = await c.req.text();
  const signature = c.req.header("Stripe-Signature");

  // Verify webhook signature
  // Process the event

  const sql = createDb(c.env.DATABASE_URL);
  await sql`
    INSERT INTO webhook_events (source, payload)
    VALUES ('stripe', ${body})
  `;

  return c.json({ received: true });
});
```

## Built-in Routes

Every app includes:

```
GET /health          # Health check
GET /                # Dashboard (SSR)
GET /api/charts      # List charts
GET /api/charts/:id  # Get chart config
POST /api/charts/:id/query  # Execute chart query
```

## Testing Routes

Test locally with curl:

```bash
# GET
curl http://localhost:8787/api/customers

# POST
curl -X POST http://localhost:8787/api/orders \
  -H "Content-Type: application/json" \
  -d '{"customerId": 1, "amount": 99.99}'
```

## Next Steps

<CardGroup cols={2}>
  <Card title="Scheduled Jobs" icon="clock" href="/apps/scheduled-jobs">
    Automate data pipelines
  </Card>
  <Card title="Deploy" icon="rocket" href="/deploy/cloudflare">
    Go live with your API
  </Card>
</CardGroup>
